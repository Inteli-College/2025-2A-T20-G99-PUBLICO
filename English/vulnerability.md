# Vulnerability Mapping in Three-Tier Architectures

## 1. Scope
Reference architecture with Web/App/DB layers in a hybrid environment (on-prem + cloud), including load balancers, TLS, queues, and cache.

## 2. Simplified Dataflow (ASCII)
Client ──HTTPS/TLS──> Web ──mTLS/TLS──> App ──TLS/Native──> DB
                         │                 └──> Cache/Queue/Services
                         └──> CDN/WAF

## 3. Assets and Surfaces
- External traffic (public TLS, public certificates).  
- East-west service traffic (mTLS, secrets, internal certificates).  
- Secret storage (KMS, vaults, files, env vars).  
- Crypto libraries in services and images.

## 4. Vulnerability Catalog (summary)
| ID | Layer | Description | Impact | Detection | Initial Mitigation |
|----|------|-------------|--------|-----------|--------------------|
| V1 | Web  | Classic TLS without PQC/hybrid | Confidentiality | CBOM + TLS logs | Hybrid handshake, cipher suite policies |
| V2 | App  | Hard-coded RSA/ECC dependency | Integrity/Availability | SAST + CBOM | Crypto abstraction + PQC mapping |
| V3 | App  | Lack of key/cert rotation | Compliance | KMS telemetry | Automated rotation playbooks |
| V4 | DB   | At-rest crypto not inventoried | Confidentiality | CBOM + KMS audit | PQC-ready keys, periodic validation |
| V5 | Mesh | mTLS across heterogeneous services | Channel breakage | PCAP/Service mesh | TLS profiles with PQC KEM and fallback |
| V6 | CI/CD| Images with outdated crypto libs | Lib exploitation | Image scanners | Security gates and controlled rebuild |

## 5. PQC Mapping
- Channels: adopt TLS profiles with PQC KEM (where available) or gradually deploy hybrid strategy.  
- Signatures: replace ECDSA with post-quantum schemes supported in build/signing pipelines.  
- Secrets: prepare rotation and storage compatible with larger keys and new formats.

## 6. Prioritization Criteria
- External exposure first (Web/Edge), then critical east-west.  
- Low-effort/high-impact: centralized libraries, TLS termination, API gateways.  
- Shared dependencies: common libs used across multiple services.

## 7. Outputs
- Mapping table service → current algorithm → target PQC algorithm.  
- List of candidate PRs/patches for the migration sprint.
